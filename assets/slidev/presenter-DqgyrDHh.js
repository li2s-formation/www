import{d as z,b as x,T as t,n as w,o as a,al as H,Q as T,f,ah as W,i as b,am as O,g as e,ad as j,an as U,ae as q,z as M,F as G,t as h,r as B,K as R,Y as K,L as Q,P as Y,ao as J,e as u,B as X,w as $,k as Z,a9 as V}from"../modules/vue-DIM-xMD1.js";import{d as r,a as ee,u as te,e as se,h as ne,j as oe,k as re,l as ae,m as ie,s as le,n as ue,_ as ce}from"../index-jJGODVUG.js";import{u as de,a as E,S as me}from"./SlideWrapper-DL4-58Zj.js";import{r as fe,u as pe,a as ve,_ as xe,o as _e,b as ke,S as ge,G as Se,c as ye,d as we}from"./shortcuts-CMUwuegK.js";import{_ as be,C as Ce}from"./NoteDisplay.vue_vue_type_style_index_0_lang-DjF4ekOp.js";import{_ as he}from"./CurrentProgressBar.vue_vue_type_script_setup_true_lang-CIjBkpuc.js";import{_ as $e}from"./DrawingControls.vue_vue_type_style_index_0_lang-BhbO6gu4.js";import{_ as I}from"./IconButton.vue_vue_type_script_setup_true_lang-F341LHGG.js";import{a as Me}from"./useSlideInfo-C7wSTS3v.js";import"../modules/shiki-DyEvVH_v.js";import"./context-CjUT6PAo.js";import"../modules/unplugin-icons-BrdCVQyQ.js";const ze=z({__name:"NoteStatic",props:{no:{},class:{},clicksContext:{}},setup(d){const i=d,{info:n}=Me(i.no);return(l,c)=>(a(),x(be,{class:w(i.class),note:t(n)?.note,"note-html":t(n)?.noteHTML,"clicks-context":d.clicksContext},null,8,["class","note","note-html","clicks-context"]))}}),De={"h-full":"","w-full":""},Ne={key:0,"w-full":"","h-full":"",flex:"~ col gap-4 items-center justify-center"},Ae=z({__name:"ScreenCaptureMirror",setup(d){const i=H("video"),n=T(null),l=T(!1);async function c(){n.value=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1,selfBrowserSurface:"include",preferCurrentTab:!1}),i.value.srcObject=n.value,i.value.play(),l.value=!0,n.value.addEventListener("inactive",()=>{i.value.srcObject=null,l.value=!1}),n.value.addEventListener("ended",()=>{i.value.srcObject=null,l.value=!1})}return(p,o)=>(a(),f("div",De,[W(e("video",{ref_key:"video",ref:i,class:"w-full h-full object-contain"},null,512),[[O,l.value]]),l.value?b("v-if",!0):(a(),f("div",Ne,[o[0]||(o[0]=e("div",{op50:""},[j(" Use screen capturing to mirror your main screen back to presenter view."),e("br"),j(" Click the button below and "),e("b",null,"select your other monitor or window"),j(". ")],-1)),e("button",{class:"slidev-form-button",onClick:c}," Start Screen Mirroring ")]))]))}});function Fe(){const d=U(100,{controls:!0}),i=q(r,"timerStatus"),n=M(()=>{if(r.timerStatus==="stopped"&&r.timerStartedAt===0)return{h:"",m:"-",s:"--",ms:"-"};d.counter.value;const m=Date.now()-r.timerStartedAt;let _=Math.floor(m/1e3/60/60).toString();_==="0"&&(_="");let S=Math.floor(m/1e3/60).toString();_&&(S=S.padStart(2,"0"));const D=Math.floor(m/1e3%60).toString().padStart(2,"0"),N=Math.floor(m%1e3/100).toString();return{h:_,m:S,s:D,ms:N}});function l(){d.pause(),r.timerStatus="stopped",r.timerStartedAt=0,r.timerPausedAt=0}function c(){r.timerStatus==="stopped"?(r.timerStatus="running",r.timerStartedAt=Date.now()):r.timerStatus==="paused"&&(r.timerStatus="running",r.timerStartedAt=Date.now()-(r.timerPausedAt-r.timerStartedAt)),d.resume()}function p(){r.timerStatus="paused",r.timerPausedAt=Date.now(),d.pause()}function o(){r.timerStatus==="running"?p():c()}return{state:i,timer:n,reset:l,toggle:o,resume:c,pause:p}}const Pe={class:"w-22px cursor-pointer"},je={class:"group-not-hover:hidden flex flex-col items-center"},Be={key:0,class:"i-carbon:pause text-lg"},Te={key:1,class:"i-carbon:play"},Le={class:"text-3xl px-3 my-auto font-mono"},Re={class:"text-base op50"},Ve=z({__name:"TimerInlined",setup(d){const{state:i,timer:n,reset:l,toggle:c}=Fe();return(p,o)=>(a(),f("div",{class:w(["group flex items-center justify-center pl-4 select-none",{running:"text-green6 dark:text-green3",paused:"text-orange6 dark:text-orange3",stopped:"op50"}[t(i)]])},[e("div",Pe,[o[3]||(o[3]=e("div",{class:"i-carbon:time group-hover:hidden text-xl"},null,-1)),e("div",je,[e("div",{class:"relative op-80 hover:op-100",onClick:o[0]||(o[0]=(...m)=>t(c)&&t(c)(...m))},[t(i)==="running"?(a(),f("div",Be)):(a(),f("div",Te))]),e("div",{class:"op-80 hover:op-100",onClick:o[1]||(o[1]=(...m)=>t(l)&&t(l)(...m))},[...o[2]||(o[2]=[e("div",{class:"i-carbon:renew"},null,-1)])])])]),e("div",Le,[t(n).h?(a(),f(G,{key:0},[e("span",null,h(t(n).h),1),o[4]||(o[4]=e("span",{op50:""},":",-1))],64)):b("v-if",!0),e("span",null,h(t(n).m),1),o[5]||(o[5]=e("span",{op50:""},":",-1)),e("span",null,h(t(n).s),1),e("span",Re,"."+h(t(n).ms),1)])],2))}}),Ee={class:"bg-main h-full slidev-presenter grid grid-rows-[max-content_1fr] of-hidden"},Ie={flex:"~ gap-4 items-center",border:"b main",p1:""},We={class:"relative grid-section next flex flex-col p-2 lg:p-4"},Oe={key:1,class:"h-full flex justify-center items-center"},Ge={key:0,class:"grid-section note of-auto"},He={key:1,class:"grid-section note grid grid-rows-[1fr_min-content] overflow-hidden"},Ue={class:"grid-section bottom flex"},qe=z({__name:"presenter",setup(d){const i=V(),n=B();fe(),pe(n),ve();const{clicksContext:l,currentSlideNo:c,currentSlideRoute:p,hasNext:o,nextRoute:m,slides:_,getPrimaryClicks:S}=ee(),{isDrawing:D}=de();te({title:`Presenter - ${le}`}),B(!1);const N=M(()=>_.value.map(k=>{const s=B(0);return{context:se(s,k?.meta.slide?.frontmatter.clicksStart??0,k?.meta.clicks),clicks:s}})),v=M(()=>l.value.current<l.value.total?[p.value,l.value.current+1]:o.value?[m.value,0]:null),C=M(()=>v.value&&N.value[v.value[0].no-1]);R(v,()=>{C.value&&v.value&&(C.value.clicks.value=v.value[1])},{immediate:!0});const y=K("slidev-presenter-main-slide-mode","slides"),L=T();return Q(()=>{const k=n.value.querySelector("#slide-content"),s=Y(J()),A=V();R(()=>{if(!A.value||D.value||!ue.value||!k)return;const g=k.getBoundingClientRect(),F=(s.x-g.left)/g.width*100,P=(s.y-g.top)/g.height*100;if(!(F<0||F>100||P<0||P>100))return{x:F,y:P}},g=>{r.cursor=g})}),(k,s)=>(a(),f(G,null,[e("div",Ee,[e("div",null,[u(he)]),e("div",{class:w(["grid-container",`layout${t(ne)}`])},[e("div",{ref_key:"main",ref:n,class:"relative grid-section main flex flex-col"},[e("div",Ie,[s[3]||(s[3]=e("span",{op50:"",px2:""},"Current",-1)),s[4]||(s[4]=e("div",{"flex-auto":""},null,-1)),u(xe,{modelValue:t(y),"onUpdate:modelValue":s[0]||(s[0]=A=>X(y)?y.value=A:null),options:[{label:"Slides",value:"slides"},{label:"Screen Mirror",value:"mirror"}]},null,8,["modelValue"])]),t(y)==="mirror"?(a(),x(Ae,{key:0})):b("v-if",!0),b(" We use v-show here to still infer the clicks context "),W(u(E,{key:"main",class:"p-2 lg:p-4 flex-auto","is-main":"",onContextmenu:t(_e)},{default:$(()=>[u(ge,{"render-context":"presenter"})]),_:1},8,["onContextmenu"]),[[O,t(y)==="slides"]]),(a(),x(Ce,{key:t(p)?.no,"clicks-context":t(S)(t(p)),class:"w-full pb2 px4 flex-none"},null,8,["clicks-context"]))],512),e("div",We,[v.value&&C.value?(a(),x(E,{key:"next"},{default:$(()=>[(a(),x(me,{key:v.value[0].no,"clicks-context":C.value.context,route:v.value[0],"render-context":"previewNext"},null,8,["clicks-context","route"]))]),_:1})):(a(),f("div",Oe,[...s[5]||(s[5]=[e("div",{class:"text-gray-500"}," End of the presentation ",-1)])])),s[6]||(s[6]=e("div",{class:"absolute left-0 top-0 bg-main border-b border-r border-main px2 py1 op50 text-sm"}," Next ",-1))]),L.value&&t(oe)?(a(),f("div",Ge,[u(t(L))])):(a(),f("div",He,[(a(),x(ze,{key:`static-${t(c)}`,no:t(c),class:"w-full max-w-full h-full overflow-auto p-2 lg:p-4",style:Z({fontSize:`${t(re)}em`}),"clicks-context":t(l)},null,8,["no","style","clicks-context"])),s[10]||(s[10]=e("div",{"border-t":"","border-main":""},null,-1)),e("div",{class:w(["py-1 px-2 text-sm transition",t(i)?"":"op25"])},[u(I,{title:"Increase font size",onClick:t(ae)},{default:$(()=>[...s[7]||(s[7]=[e("div",{class:"i-carbon:zoom-in"},null,-1)])]),_:1},8,["onClick"]),u(I,{title:"Decrease font size",onClick:t(ie)},{default:$(()=>[...s[8]||(s[8]=[e("div",{class:"i-carbon:zoom-out"},null,-1)])]),_:1},8,["onClick"]),b("v-if",!0)],2)])),e("div",Ue,[u(ke,{persist:!0,class:w(["transition",t(i)?"":"op25"])},null,8,["class"]),s[11]||(s[11]=e("div",{"flex-auto":""},null,-1)),u(Ve)]),(a(),x($e,{key:2}))],2)]),u(Se),u(ye),u(we)],64))}}),at=ce(qe,[["__scopeId","data-v-49c8eaaa"]]);export{at as default};
